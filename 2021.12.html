<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue 弹窗清除状态 | 午后斜阳 暖暖橘黄</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="姜嘉林的网站">
    
    <link rel="preload" href="/Cherry/assets/css/0.styles.b9f34bb3.css" as="style"><link rel="preload" href="/Cherry/assets/js/app.5a1e4f07.js" as="script"><link rel="preload" href="/Cherry/assets/js/2.887b5b9f.js" as="script"><link rel="preload" href="/Cherry/assets/js/22.3196fb95.js" as="script"><link rel="prefetch" href="/Cherry/assets/js/10.cd6f20a6.js"><link rel="prefetch" href="/Cherry/assets/js/11.3d57c49f.js"><link rel="prefetch" href="/Cherry/assets/js/12.bad96b18.js"><link rel="prefetch" href="/Cherry/assets/js/13.ec383881.js"><link rel="prefetch" href="/Cherry/assets/js/14.0e520a5e.js"><link rel="prefetch" href="/Cherry/assets/js/15.fd1ad449.js"><link rel="prefetch" href="/Cherry/assets/js/16.870a7b58.js"><link rel="prefetch" href="/Cherry/assets/js/17.dd48f4c7.js"><link rel="prefetch" href="/Cherry/assets/js/18.823f5b2d.js"><link rel="prefetch" href="/Cherry/assets/js/19.13a4ca37.js"><link rel="prefetch" href="/Cherry/assets/js/20.e93402a4.js"><link rel="prefetch" href="/Cherry/assets/js/21.ed0f4efe.js"><link rel="prefetch" href="/Cherry/assets/js/23.1734bea6.js"><link rel="prefetch" href="/Cherry/assets/js/3.12fb9a5d.js"><link rel="prefetch" href="/Cherry/assets/js/4.ec6ff4f4.js"><link rel="prefetch" href="/Cherry/assets/js/5.ceb362cc.js"><link rel="prefetch" href="/Cherry/assets/js/6.e5c7fb3b.js"><link rel="prefetch" href="/Cherry/assets/js/7.9bbd28ae.js"><link rel="prefetch" href="/Cherry/assets/js/8.80f602c4.js"><link rel="prefetch" href="/Cherry/assets/js/9.b5eb54e3.js">
    <link rel="stylesheet" href="/Cherry/assets/css/0.styles.b9f34bb3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Cherry/" class="home-link router-link-active"><!----> <span class="site-name">午后斜阳 暖暖橘黄</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Cherry/" class="nav-link">
  Home
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Cherry/" class="nav-link">
  Home
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Cherry/" aria-current="page" class="sidebar-link">Orange</a></li><li><a href="/Cherry/2019.12.html" class="sidebar-link">2019年12月</a></li><li><a href="/Cherry/2020.01.html" class="sidebar-link">2020年1月</a></li><li><a href="/Cherry/2020.04.html" class="sidebar-link">2020年4月</a></li><li><a href="/Cherry/2020.05.html" class="sidebar-link">2020年5月</a></li><li><a href="/Cherry/2020.06.html" class="sidebar-link">2020年6月</a></li><li><a href="/Cherry/2020.07.html" class="sidebar-link">2020年7月-7月你好</a></li><li><a href="/Cherry/2020.08.html" class="sidebar-link">2020年8月</a></li><li><a href="/Cherry/2020.09.html" class="sidebar-link">2020年9月-金秋9月</a></li><li><a href="/Cherry/2020.10.html" class="sidebar-link">2020年10月</a></li><li><a href="/Cherry/2020.11.html" class="sidebar-link">2020年11月</a></li><li><a href="/Cherry/2021.02.html" class="sidebar-link">2021年2月</a></li><li><a href="/Cherry/2021.03.html" class="sidebar-link">2021 年 3 月</a></li><li><a href="/Cherry/2021.04.html" class="sidebar-link">2021 年 4 月</a></li><li><a href="/Cherry/2021.06.html" class="sidebar-link">2021.6</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-弹窗清除状态"><a href="#vue-弹窗清除状态" class="header-anchor">#</a> vue 弹窗清除状态</h1> <h2 id="使用弹窗的方式"><a href="#使用弹窗的方式" class="header-anchor">#</a> 使用弹窗的方式</h2> <p>一般复杂的业务组件，都会将弹窗封装成组件，然后在父组件中通过<code>$refs.xxx</code>的方式调用该组件的实例方法，使弹层展示。</p> <p>比如有如下Create组件：</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mtd-modal</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>这是一个弹窗<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40%<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modal-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            something
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foot<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mtd-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cancel-text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cancel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>取消<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mtd-button</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mtd-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>确定<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mtd-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mtd-modal</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> Prop<span class="token punctuation">,</span> namespace <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/decorators'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> api <span class="token keyword">from</span> <span class="token string">'@/api'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    components<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Create</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    appKey<span class="token operator">:</span> string<span class="token punctuation">;</span>
    visible<span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    type<span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">'create'</span><span class="token punctuation">;</span>
    newExpForm <span class="token operator">=</span> <span class="token punctuation">{</span>
        description<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    loading<span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token function">openModal</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> info<span class="token punctuation">.</span>modalType <span class="token operator">||</span> <span class="token string">'create'</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span> description<span class="token punctuation">,</span> appKey <span class="token punctuation">}</span> <span class="token operator">=</span> info<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>newExpForm<span class="token punctuation">.</span>description <span class="token operator">=</span> description<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>appKey <span class="token operator">=</span> appKey<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>visible<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>在父组件中：</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Create</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>createRef<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Create</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// ...</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>createRef<span class="token punctuation">.</span><span class="token function">openModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token comment">// ..})</span>
<span class="token comment">// ...</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="这种写法带来的问题"><a href="#这种写法带来的问题" class="header-anchor">#</a> 这种写法带来的问题</h2> <ol><li><p>弹窗组件在父组件加载的时候就初始化，而在页面的生命周期中，可能都用不到此弹窗组件，造成了资源浪费；</p></li> <li><p>由于弹窗组件实例不会被注销，所以在关闭弹窗后弹窗的状态也不能被注销。</p></li></ol> <h2 id="清除弹窗组件状态的方式"><a href="#清除弹窗组件状态的方式" class="header-anchor">#</a> 清除弹窗组件状态的方式</h2> <p>针对上述弹窗组件调用的方式，要想清除组件状态，主要有以下两种方式：</p> <ol><li>调用子组件<code>openModal</code>的时候进行初始化，重置成原始状态</li> <li>在关闭弹窗的时候重置组件状态</li></ol> <p>但是这两种方式都面临着一个问题，即需要在不同的地方维护两份组件状态，如果新加状态的话，需要在两个地方加，万一忘记加了，就产生了bug。</p> <p>所以说我们需要一种比较优雅的方式解决这个问题。</p> <h2 id="清除状态"><a href="#清除状态" class="header-anchor">#</a> 清除状态</h2> <p>我们知道，如果一个组件是新渲染出来的组件，那它本身的状态一定是新的。所以每次打开的弹窗如果都是一个新的弹窗，那一定不会存在状态残留的问题。</p> <p>关键点：每次打开一个新的弹窗组件实例</p> <h2 id="通过重新渲染的方式清除状态"><a href="#通过重新渲染的方式清除状态" class="header-anchor">#</a> 通过重新渲染的方式清除状态</h2> <p>要想重新渲染组件，主要有以下几种方式：</p> <ul><li>使组件的<code>key</code>值变化</li> <li>v-if</li></ul> <p>由于处理的是单个组件，所以我们采用<code>v-if</code>的方式使组件重新渲染。</p> <p>对于弹层组件，我们做如下改动：</p> <ul><li>去掉组件内部的<code>openModal</code>方法，将所有操作放在组件的生命周期中，因为每次弹窗，组件都会经历完整的生命周期;</li> <li>使<code>mtd-modal</code>的<code>visible</code>默认为<code>true</code>;</li> <li>监听<code>mtd-modal</code>的<code>closed</code>事件或者<code>watch</code>组件的<code>visible</code>，当<code>mtd-modal</code>关闭的时候向上发射关闭事件<code>this.$emit('closed')</code>;</li> <li>在父组件中通过<code>v-if</code>控制弹层组件的显示与隐藏。</li> <li>所有参数通过<code>props</code>传递</li></ul> <p>经过上述改动，弹层组件可以抽象如下：</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mtd-modal</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>特征上线<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>80%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@closed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleClosed<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modal-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>exp-create-foot<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mtd-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cancel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>取消<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mtd-button</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mtd-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                上线
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mtd-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mtd-modal</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> Prop<span class="token punctuation">,</span> Watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/decorators'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Online</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    @<span class="token function">Prop</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    type<span class="token operator">:</span> string<span class="token punctuation">;</span>

    @<span class="token function">Prop</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    appKey<span class="token operator">:</span> string<span class="token punctuation">;</span>

    visible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token function">handleClosed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>visible<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>在父组件中：</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Online</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onlineRef<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>showOnline<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@closed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleClosed<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:appKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>appKey<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Online</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> Vue<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> Prop<span class="token punctuation">,</span> Watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/decorators'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Online <span class="token keyword">from</span> <span class="token string">'./online/index.vue'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    components<span class="token operator">:</span> <span class="token punctuation">{</span> Online <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Scene</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span> <span class="token punctuation">{</span>
    @<span class="token function">Prop</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    appKey<span class="token operator">:</span> string<span class="token punctuation">;</span>

    showOnline <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token function">online</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showOnline <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">handleClosed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showOnline <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/9/2022, 3:28:10 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/Cherry/assets/js/app.5a1e4f07.js" defer></script><script src="/Cherry/assets/js/2.887b5b9f.js" defer></script><script src="/Cherry/assets/js/22.3196fb95.js" defer></script>
  </body>
</html>
